# RunPick 멀티브랜드(ASICS/NIKE/ADIDAS) 코드 개선안

기준 전제:

- 브랜드 데이터 JSON은 3개(`asics.json`, `nike.json`, `adidas.json`)가 존재
- 실제 상품 이미지는 현재 ASICS만 존재
- 멀티브랜드 라우팅은 일부 통합됐지만 화면/내비/상세 흐름은 단일 브랜드 흔적이 남아 있음

---

## 1) 현재 상태 진단 요약

잘 된 부분:

- 데이터 계층이 3브랜드로 통합됨 (`src/utils/shoe-utils.ts`)
- 브랜드/카테고리 정적 라우트가 3브랜드를 생성함
  - `src/app/brand/[brandId]/page.tsx`
  - `src/app/brand/[brandId]/[category]/page.tsx`
- 전체 신발 단위(slug) 상세 페이지 생성 가능 (`src/app/shoe/[shoeId]/page.tsx`)

주요 문제:

1. `asics` 하드코딩 링크 다수
2. non-ASICS 이미지/로고 부재로 카드·상세 이미지 깨짐 가능
3. 홈/헤더/푸터에서 브랜드 선택 진입점 부족
4. 상세 breadcrumb/복귀 링크가 브랜드와 불일치
5. 유틸/타입/스크립트 레벨의 검증 체계 부족

---

## 2) 우선순위별 개선 항목

## P0 (즉시)

### P0-1. 하드코딩 브랜드 링크 제거

문제 파일:

- `src/components/layout/Header.tsx`
- `src/components/layout/Footer.tsx`
- `src/components/hero/HeroSection.tsx`
- `src/components/hero/CategoryNav.tsx`
- `src/components/quiz/QuizResult.tsx`
- `src/app/shoe/[shoeId]/ShoeDetailClient.tsx`
- `src/app/brand/[brandId]/[category]/CategoryPageClient.tsx`

개선:

- `/brand/asics` 고정 링크를 동적 링크로 치환
- 원칙:
  - 글로벌 진입은 `/brand`(브랜드 선택 페이지)로 통일
  - 상세/카테고리 내부는 현재 `brandId` 기반 링크 사용
  - 퀴즈 결과는 추천 신발의 `brandId`로 연결

### P0-2. 이미지 폴백 체계 도입 (ASICS-only 이미지 전제 대응)

문제:

- `public/shoes`에 NIKE/ADIDAS 이미지가 없어 `next/image`에서 404 표시

개선:

- 공통 `SmartShoeImage` 컴포넌트 도입:
  - 기본: `shoe.imageUrl` 로드 시도
  - 실패 시: `/shoes/placeholder-shoe.webp`로 폴백
  - 폴백 상태에서 `사진 준비중` 배지 노출
- 적용 대상:
  - `src/components/shoe/ShoeCard.tsx`
  - `src/components/quiz/QuizResult.tsx`
  - `src/app/shoe/[shoeId]/ShoeDetailClient.tsx`

### P0-3. 상세 breadcrumb 브랜드 정합성 복구

문제:

- 신발이 NIKE/ADIDAS여도 breadcrumb가 ASICS로 고정됨

개선:

- `shoe.brandId` 기반으로 브랜드명/경로 생성
- `getBrandById(shoe.brandId)` 사용
- `카탈로그로 돌아가기`, `/brand/{brandId}/{category}` 링크 일관화

---

## P1 (구조 개선)

### P1-1. `/brand` 인덱스 페이지 신설 (브랜드 선택 허브)

신규:

- `src/app/brand/page.tsx`

기능:

- `getAllBrands()`로 브랜드 카드 목록 렌더
- 브랜드 카드 클릭 -> `/brand/{brandId}`
- 추후 로고 추가 시 자연스럽게 표시

### P1-2. 브랜드 배열 하드코딩 제거

문제:

- `['asics', 'nike', 'adidas']`가 라우트 파일에 중복 선언

개선:

- `src/utils/brand-utils.ts` 또는 `shoe-utils.ts`에 `getAllBrandIds()` 추가
- `generateStaticParams()`는 해당 함수만 참조

### P1-3. 브랜드별 추천/유사 모델 정책 명시

이슈:

- `getSimilarShoes()`가 현재 브랜드 구분 없이 카테고리/서브카테고리 기준으로 혼합 추천

개선안:

- 기본 정책을 명시:
  - 옵션 A: 동일 브랜드 우선(사용자 기대치 높음)
  - 옵션 B: 크로스브랜드 추천(비교 탐색 강화)
- 구현:
  - `getSimilarShoes(shoe, { sameBrandFirst: true })` 형태 확장

---

## P2 (확장성/품질)

### P2-1. 색상 토큰 의미화 (ASICS 전용 변수명 제거)

문제:

- `--color-asics-blue`, `--color-asics-accent`가 전역에서 디자인 토큰처럼 사용됨

개선:

- 의미 토큰으로 이관:
  - `--color-primary`, `--color-accent`
- 브랜드 페이지 루트에서 동적 주입:
  - `style={{ '--color-primary': brand.color }}` 또는 데이터 기반 팔레트

### P2-2. 데이터/자산 검증 스크립트 추가

신규 스크립트 제안:

- `npm run validate:catalog`

검증 항목:

- `brand.id` vs `shoe.brandId` 일치
- `slug`, `id` 중복 여부
- 카테고리/서브카테고리 유효성
- 이미지/로고 파일 존재 여부

### P2-3. 빌드/린트 스크립트 정비

관측:

- 현재 `npm run lint`가 Next 16 환경에서 정상 동작하지 않음

개선:

- `lint`를 `eslint . --max-warnings=0`로 교체
- 필요 시 `lint:fix` 추가

---

## 3) 권장 구현 순서

1. P0-1 링크 정합성 복구
2. P0-2 이미지 폴백 컴포넌트 도입
3. P0-3 상세 breadcrumb 수정
4. P1-1 `/brand` 페이지 추가 + 헤더/푸터 진입점 교체
5. P1-2 브랜드 ID 하드코딩 제거
6. P2 데이터 검증/린트 스크립트 정리

---

## 4) 완료 기준 (Definition of Done)

- non-ASICS 신발 카드를 열어도 이미지가 깨지지 않고 폴백 UI가 노출된다
- 어느 브랜드 페이지/카테고리/상세에서도 링크가 해당 브랜드 컨텍스트를 유지한다
- 홈/헤더/푸터에서 3브랜드 탐색 진입이 가능하다
- 정적 라우트 생성이 브랜드 리스트 기반으로 자동화된다
- `validate:catalog` 실행 시 누락 자산/데이터 오류를 즉시 확인할 수 있다

---

## 5) 바로 실행 가능한 첫 작업 묶음 (추천)

- `src/app/shoe/[shoeId]/ShoeDetailClient.tsx`의 ASICS 고정 링크 제거
- `src/components/layout/Header.tsx`, `src/components/layout/Footer.tsx` 링크를 `/brand` 허브로 변경
- `src/components/shoe/ShoeCard.tsx`에 이미지 폴백 적용
- `src/app/brand/page.tsx` 신설로 브랜드 선택 진입 구성

